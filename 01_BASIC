-- SELECT 기본 문법
-- 데이터를 조회할 때 사용하는 가장 기본 문법
SELECT column1, column2
FROM table_name;

-- 예시: 고객 테이블에서 이름과 나이를 조회
SELECT name, age
FROM customers;


-- WHERE 조건문
-- 특정 조건에 맞는 행만 선택
SELECT name, age
FROM customers
WHERE age >= 30;

-- 여러 조건 결합 (AND / OR)
SELECT name, age, city
FROM customers
WHERE city = 'Seoul'
  AND age >= 25;


-- GROUP BY (그룹별 집계)
-- 동일한 값끼리 묶어서 SUM, AVG, COUNT 등 집계함수 사용
SELECT city, COUNT(*) AS num_customers
FROM customers
GROUP BY city;


-- HAVING (그룹 조건)
-- 그룹화 이후 조건 필터링
SELECT city, COUNT(*) AS num_customers
FROM customers
GROUP BY city
HAVING COUNT(*) >= 10;


-- ORDER BY (정렬)
-- 결과를 오름차순(ASC) 또는 내림차순(DESC)으로 정렬
SELECT name, age, city
FROM customers
ORDER BY age DESC;  -- 나이 내림차순

-- 여러 기준 정렬도 가능
SELECT name, city, age
FROM customers
ORDER BY city ASC, age DESC;

-- JOIN (테이블 결합)
-- 두 테이블을 공통 컬럼으로 연결해서 하나로 합침

-- INNER JOIN (교집합)
SELECT 
  c.customer_id,
  c.name,
  o.order_id,
  o.amount
FROM customers c
INNER JOIN orders o
  ON c.customer_id = o.customer_id;

-- 두 테이블 모두 존재하는 데이터만 출력


-- LEFT JOIN (왼쪽 테이블 기준)
SELECT 
  c.customer_id,
  c.name,
  o.order_id,
  o.amount
FROM customers c
LEFT JOIN orders o
  ON c.customer_id = o.customer_id;

-- customers에는 있지만 orders에는 없는 고객도 표시됨 (NULL로 표시)


-- RIGHT JOIN (오른쪽 테이블 기준)
SELECT 
  c.customer_id,
  c.name,
  o.order_id,
  o.amount
FROM customers c
RIGHT JOIN orders o
  ON c.customer_id = o.customer_id;

-- orders에는 있지만 customers에는 없는 데이터도 표시


-- FULL OUTER JOIN (합집합)
SELECT 
  c.customer_id,
  c.name,
  o.order_id,
  o.amount
FROM customers c
FULL OUTER JOIN orders o
  ON c.customer_id = o.customer_id;

-- 양쪽 테이블의 모든 데이터를 표시 (존재하지 않으면 NULL)


-- SELF JOIN (자기 자신과 결합)
-- 예: 사원 테이블에서 상사 이름을 찾기
SELECT 
  e.employee_name AS 직원,
  m.employee_name AS 상사
FROM employees e
LEFT JOIN employees m
  ON e.manager_id = m.employee_id;

---CASE WHEN (조건에 따라 값 변환)

CASE WHEN은 SQL에서 조건을 분기하여 서로 다른 값을 반환할 때 사용한다.
프로그램에서의 if-else 기능과 유사하다.

✔ 기본 문법
CASE
  WHEN 조건1 THEN 결과1
  WHEN 조건2 THEN 결과2
  ELSE 기본값
END

예시 1: 점수에 따라 등급 분류
SELECT
  name,
  score,
  CASE 
    WHEN score >= 90 THEN 'A'
    WHEN score >= 80 THEN 'B'
    WHEN score >= 70 THEN 'C'
    ELSE 'F'
  END AS grade
FROM students;

예시 2: NULL을 특정 값으로 치환
SELECT
  name,
  CASE
    WHEN phone IS NULL THEN '미입력'
    ELSE phone
  END AS phone_number
FROM customers;

예시 3: 가격대 구간 나누기
SELECT
  product_name,
  price,
  CASE
    WHEN price >= 50000 THEN '고가'
    WHEN price >= 20000 THEN '중가'
    ELSE '저가'
  END AS price_level
FROM products;

예시 4: GROUP BY 결과에 CASE 적용
SELECT
  city,
  COUNT(*) AS cnt,
  CASE
    WHEN COUNT(*) >= 50 THEN '대도시'
    WHEN COUNT(*) >= 20 THEN '중간 규모'
    ELSE '소도시'
  END AS city_group
FROM customers
GROUP BY city;

예시 5: JOIN 결과로 상태 분류
SELECT
  c.customer_id,
  c.name,
  CASE
    WHEN o.order_id IS NULL THEN '주문 없음'
    ELSE '주문 있음'
  END AS order_status
FROM customers c
LEFT JOIN orders o
  ON c.customer_id = o.customer_id;
